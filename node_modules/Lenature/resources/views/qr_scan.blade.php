@extends('layouts.app')

@section('title', 'KGGL')

@section('content_header')

@stop

@section('content')
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="row">

                    <div class="col-md-12">

                        <h4 class="m-0 text-dark col-md-6 float-left">Create Category</h4>

                    </div>
                </div>
                <br>


                <form action="/qr" method="POST" role="form" class="col-md-12" autocomplete="off">
                    {{ csrf_field() }}

                    <div class="row">
                        <div class="col-md-12">

                            <div class="col-md-6">



                                <div class="form-group @if($errors->has('name')) text-danger @endif">
                                    <label for=""> Batch Name</label>
                                    <input type="text" name="batch_code" class="form-control" value="" id="batch_code" required="required">
                                    @if($errors->has('batch_code'))
                                    <div class="error text-danger">{{ $errors->first('batch_code') }}</div>
                                    @endif

                                </div>
                                <div class="form-group @if($errors->has('name')) text-danger @endif">
                                    <label for=""> Product Name</label>
                                    <input type="text" name="product_name" class="form-control" value="" id="product_name" required="required">
                                    @if($errors->has('product_name'))
                                    <div class="error text-danger">{{ $errors->first('product_name') }}</div>
                                    @endif

                                </div>
                                <div class="form-group @if($errors->has('name')) text-danger @endif">
                                    <label for="">Price</label>
                                    <input type="text" name="item_price" class="form-control" value="" id="item_price" required="required">
                                    @if($errors->has('item_price'))
                                    <div class="error text-danger">{{ $errors->first('item_price') }}</div>
                                    @endif

                                </div>
                               




                            </div>
                        </div>
                    </div>





                    <button type="submit" class="btn btn-primary col-md-2 offset-md-1 btn-sm">Create</button>
                    <a class="btn btn-danger col-md-2  btn-sm" href='/product-categories'>Cancel </a>
                </form>



            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function() {

        $('#batch_code').focus();
        
        $('#batch_code').on('change', function() {
            var batchCode = $(this).val();

            // Make AJAX request to fetch product details
            $.ajax({
                url: '/get-product-details',
                type: 'POST',
                data: {
                    _token: '{{ csrf_token() }}',
                    batch_code: batchCode
                },
                success: function(response) {
                    if (response.success) {
                        $('#product_name').val(response.product_name);
                        $('#item_price').val(response.item_price);
                    } else {
                        alert('Product details not found for this batch code.');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching product details:', error);
                }
            });
        });
    });
</script>


@stop
